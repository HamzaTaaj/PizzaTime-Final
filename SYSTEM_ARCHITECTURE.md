# System Architecture

## ğŸ—ï¸ Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (React)                         â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Request      â”‚  â”‚ Login        â”‚  â”‚ Admin Dashboard      â”‚  â”‚
â”‚  â”‚ Access Page  â”‚  â”‚ Page         â”‚  â”‚                      â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚ - View Requests      â”‚  â”‚
â”‚  â”‚ - Form       â”‚  â”‚ - Email      â”‚  â”‚ - Filter by Status   â”‚  â”‚
â”‚  â”‚ - Submit     â”‚  â”‚ - Password   â”‚  â”‚ - Approve/Reject     â”‚  â”‚
â”‚  â”‚              â”‚  â”‚ - Get JWT    â”‚  â”‚ - Statistics         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                 â”‚                      â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                      â”‚
          â”‚ POST            â”‚ POST                 â”‚ GET/POST
          â”‚                 â”‚                      â”‚ (with JWT)
          â–¼                 â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND (Vercel Functions)                    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ submit-access-   â”‚  â”‚ admin-login  â”‚  â”‚ get-access-      â”‚  â”‚
â”‚  â”‚ request.ts       â”‚  â”‚ .ts          â”‚  â”‚ requests.ts      â”‚  â”‚
â”‚  â”‚                  â”‚  â”‚              â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚ - Validate       â”‚  â”‚ - Verify     â”‚  â”‚ - Verify JWT     â”‚  â”‚
â”‚  â”‚ - Create         â”‚  â”‚   Credentialsâ”‚  â”‚ - Fetch from     â”‚  â”‚
â”‚  â”‚   Customer       â”‚  â”‚ - Generate   â”‚  â”‚   Shopify        â”‚  â”‚
â”‚  â”‚ - Add Tags       â”‚  â”‚   JWT Token  â”‚  â”‚ - Return List    â”‚  â”‚
â”‚  â”‚ - Add Metafields â”‚  â”‚              â”‚  â”‚                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                                        â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜            â”‚
â”‚  â”‚                                               â”‚              â”‚
â”‚  â”‚ update-request-status.ts                     â”‚              â”‚
â”‚  â”‚                                               â”‚              â”‚
â”‚  â”‚ - Verify JWT                                  â”‚              â”‚
â”‚  â”‚ - Update Metafield                            â”‚              â”‚
â”‚  â”‚ - Update Tags                                 â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                  â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ Shopify Admin API
                                   â”‚ (REST API)
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SHOPIFY STORE                            â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    CUSTOMERS                                â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  Customer Record:                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ ID: 123456789                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ Email: john@example.com                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€ First Name: John                                        â”‚ â”‚
â”‚  â”‚  â”œâ”€ Last Name: Doe                                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ Tags: "access-request,pending-review"                   â”‚ â”‚
â”‚  â”‚  â””â”€ Metafields (namespace: access_request):                 â”‚ â”‚
â”‚  â”‚     â”œâ”€ company: "Example Corp"                              â”‚ â”‚
â”‚  â”‚     â”œâ”€ location: "New York, USA"                            â”‚ â”‚
â”‚  â”‚     â”œâ”€ machine_count: "5"                                   â”‚ â”‚
â”‚  â”‚     â”œâ”€ role: "Operations Manager"                           â”‚ â”‚
â”‚  â”‚     â”œâ”€ message: "Looking for solutions"                     â”‚ â”‚
â”‚  â”‚     â”œâ”€ submitted_at: "2025-12-30T10:30:00Z"                 â”‚ â”‚
â”‚  â”‚     â””â”€ status: "pending"                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Request Flow Diagrams

### 1. User Submits Access Request

```
â”Œâ”€â”€â”€â”€â”€â”€â”                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚                                                    â”‚ Shopify â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜                                                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
   â”‚                                                             â”‚
   â”‚ 1. Fill form & click Submit                                â”‚
   â”‚                                                             â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
   â”‚                                      â”‚                     â”‚
   â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
   â”‚                            â”‚ RequestAccessPage  â”‚          â”‚
   â”‚                            â”‚                    â”‚          â”‚
   â”‚                            â”‚ - Validate form    â”‚          â”‚
   â”‚                            â”‚ - Show loading     â”‚          â”‚
   â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
   â”‚                                      â”‚                     â”‚
   â”‚                                      â”‚ 2. POST /api/       â”‚
   â”‚                                      â”‚    submit-access-   â”‚
   â”‚                                      â”‚    request          â”‚
   â”‚                                      â”‚                     â”‚
   â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
   â”‚                            â”‚ API Function       â”‚          â”‚
   â”‚                            â”‚                    â”‚          â”‚
   â”‚                            â”‚ - Validate data    â”‚          â”‚
   â”‚                            â”‚ - Check required   â”‚          â”‚
   â”‚                            â”‚   fields           â”‚          â”‚
   â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
   â”‚                                      â”‚                     â”‚
   â”‚                                      â”‚ 3. Create customer  â”‚
   â”‚                                      â”‚    with metafields  â”‚
   â”‚                                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚                                      â”‚                     â”‚
   â”‚                                      â”‚ 4. Success response â”‚
   â”‚                                      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
   â”‚                            â”‚ API Function       â”‚          â”‚
   â”‚                            â”‚                    â”‚          â”‚
   â”‚                            â”‚ - Return success   â”‚          â”‚
   â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
   â”‚                                      â”‚                     â”‚
   â”‚                                      â”‚ 5. Success message  â”‚
   â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
   â”‚                            â”‚ RequestAccessPage  â”‚          â”‚
   â”‚                            â”‚                    â”‚          â”‚
   â”‚                            â”‚ - Show success     â”‚          â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ - Reset form       â”‚          â”‚
   â”‚ 6. See success message     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
   â”‚                                                             â”‚
```

### 2. Admin Login Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin â”‚                                              â”‚ Backend  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜                                              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚                                                       â”‚
    â”‚ 1. Enter email & password                            â”‚
    â”‚                                                       â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
    â”‚                          â”‚                           â”‚
    â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
    â”‚                â”‚ LoginPage        â”‚                  â”‚
    â”‚                â”‚                  â”‚                  â”‚
    â”‚                â”‚ - Validate input â”‚                  â”‚
    â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
    â”‚                          â”‚                           â”‚
    â”‚                          â”‚ 2. POST /api/admin-login  â”‚
    â”‚                          â”‚    {email, password}      â”‚
    â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                          â”‚                           â”‚
    â”‚                          â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                          â”‚                  â”‚ admin-login.ts  â”‚
    â”‚                          â”‚                  â”‚                 â”‚
    â”‚                          â”‚                  â”‚ - Check env varsâ”‚
    â”‚                          â”‚                  â”‚ - Verify creds  â”‚
    â”‚                          â”‚                  â”‚ - Generate JWT  â”‚
    â”‚                          â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                          â”‚                           â”‚
    â”‚                          â”‚ 3. Return JWT token       â”‚
    â”‚                          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
    â”‚                â”‚ LoginPage        â”‚                  â”‚
    â”‚                â”‚                  â”‚                  â”‚
    â”‚                â”‚ - Save token     â”‚                  â”‚
    â”‚                â”‚ - Save user info â”‚                  â”‚
    â”‚                â”‚ - Navigate to    â”‚                  â”‚
    â”‚                â”‚   dashboard      â”‚                  â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚                  â”‚
    â”‚ 4. Redirected  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
    â”‚    to dashboard                                      â”‚
    â”‚                                                       â”‚
```

### 3. Admin Views Requests

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin â”‚                                         â”‚ Shopify â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜                                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚                                                  â”‚
    â”‚ 1. Navigate to /admin                           â”‚
    â”‚                                                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
    â”‚                      â”‚                          â”‚
    â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚            â”‚ AdminDashboard     â”‚               â”‚
    â”‚            â”‚                    â”‚               â”‚
    â”‚            â”‚ - Check auth token â”‚               â”‚
    â”‚            â”‚ - Show loading     â”‚               â”‚
    â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚                      â”‚                          â”‚
    â”‚                      â”‚ 2. GET /api/get-access-  â”‚
    â”‚                      â”‚    requests              â”‚
    â”‚                      â”‚    Authorization: Bearer â”‚
    â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚                      â”‚                     â”‚    â”‚
    â”‚                      â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚                      â”‚           â”‚ get-access-         â”‚
    â”‚                      â”‚           â”‚ requests.ts         â”‚
    â”‚                      â”‚           â”‚                     â”‚
    â”‚                      â”‚           â”‚ - Verify JWT        â”‚
    â”‚                      â”‚           â”‚ - Fetch customers   â”‚
    â”‚                      â”‚           â”‚   with tag          â”‚
    â”‚                      â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                      â”‚                     â”‚
    â”‚                      â”‚                     â”‚ 3. Get customers
    â”‚                      â”‚                     â”‚    with tag
    â”‚                      â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                      â”‚                     â”‚               â”‚
    â”‚                      â”‚                     â”‚ 4. For each:  â”‚
    â”‚                      â”‚                     â”‚    Get        â”‚
    â”‚                      â”‚                     â”‚    metafields â”‚
    â”‚                      â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                      â”‚                     â”‚               â”‚
    â”‚                      â”‚                     â”‚ 5. Return dataâ”‚
    â”‚                      â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                      â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚                      â”‚           â”‚ get-access-         â”‚   â”‚
    â”‚                      â”‚           â”‚ requests.ts         â”‚   â”‚
    â”‚                      â”‚           â”‚                     â”‚   â”‚
    â”‚                      â”‚           â”‚ - Format response   â”‚   â”‚
    â”‚                      â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                      â”‚                     â”‚               â”‚
    â”‚                      â”‚ 6. Return formatted â”‚               â”‚
    â”‚                      â”‚    request list     â”‚               â”‚
    â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚               â”‚
    â”‚            â”‚ AdminDashboard     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚            â”‚                    â”‚                          â”‚
    â”‚            â”‚ - Display requests â”‚                          â”‚
    â”‚            â”‚ - Show stats       â”‚                          â”‚
    â”‚            â”‚ - Enable filters   â”‚                          â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                          â”‚
    â”‚ 7. View    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
    â”‚    requests                                                â”‚
    â”‚                                                             â”‚
```

### 4. Admin Approves/Rejects Request

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin â”‚                                         â”‚ Shopify â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜                                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚                                                  â”‚
    â”‚ 1. Click Approve/Reject                         â”‚
    â”‚                                                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
    â”‚                      â”‚                          â”‚
    â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚            â”‚ AdminDashboard     â”‚               â”‚
    â”‚            â”‚                    â”‚               â”‚
    â”‚            â”‚ - Disable button   â”‚               â”‚
    â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚                      â”‚                          â”‚
    â”‚                      â”‚ 2. POST /api/update-     â”‚
    â”‚                      â”‚    request-status        â”‚
    â”‚                      â”‚    {customerId, status}  â”‚
    â”‚                      â”‚    Authorization: Bearer â”‚
    â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚                      â”‚                     â”‚    â”‚
    â”‚                      â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚                      â”‚           â”‚ update-request-     â”‚
    â”‚                      â”‚           â”‚ status.ts           â”‚
    â”‚                      â”‚           â”‚                     â”‚
    â”‚                      â”‚           â”‚ - Verify JWT        â”‚
    â”‚                      â”‚           â”‚ - Get metafield ID  â”‚
    â”‚                      â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                      â”‚                     â”‚
    â”‚                      â”‚                     â”‚ 3. Get current
    â”‚                      â”‚                     â”‚    metafields
    â”‚                      â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                      â”‚                     â”‚               â”‚
    â”‚                      â”‚                     â”‚ 4. Return dataâ”‚
    â”‚                      â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                      â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚                      â”‚           â”‚ update-request-     â”‚   â”‚
    â”‚                      â”‚           â”‚ status.ts           â”‚   â”‚
    â”‚                      â”‚           â”‚                     â”‚   â”‚
    â”‚                      â”‚           â”‚ - Update status     â”‚   â”‚
    â”‚                      â”‚           â”‚   metafield         â”‚   â”‚
    â”‚                      â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                      â”‚                     â”‚               â”‚
    â”‚                      â”‚                     â”‚ 5. Update     â”‚
    â”‚                      â”‚                     â”‚    metafield  â”‚
    â”‚                      â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                      â”‚                     â”‚               â”‚
    â”‚                      â”‚                     â”‚ 6. Update tagsâ”‚
    â”‚                      â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                      â”‚                     â”‚               â”‚
    â”‚                      â”‚                     â”‚ 7. Success    â”‚
    â”‚                      â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                      â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚                      â”‚           â”‚ update-request-     â”‚   â”‚
    â”‚                      â”‚           â”‚ status.ts           â”‚   â”‚
    â”‚                      â”‚           â”‚                     â”‚   â”‚
    â”‚                      â”‚           â”‚ - Return success    â”‚   â”‚
    â”‚                      â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                      â”‚                     â”‚               â”‚
    â”‚                      â”‚ 8. Success response â”‚               â”‚
    â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚               â”‚
    â”‚            â”‚ AdminDashboard     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚            â”‚                    â”‚                          â”‚
    â”‚            â”‚ - Refresh list     â”‚                          â”‚
    â”‚            â”‚ - Update UI        â”‚                          â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                          â”‚
    â”‚ 9. See     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
    â”‚    updated                                                 â”‚
    â”‚    status                                                  â”‚
    â”‚                                                             â”‚
```

## ğŸ” Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     JWT Token Lifecycle                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. LOGIN
   Admin enters credentials
        â†“
   Backend verifies against env vars
        â†“
   Generate JWT with payload:
   {
     email: "admin@example.com",
     role: "admin",
     exp: timestamp + 24h
   }
        â†“
   Return token to frontend
        â†“
   Frontend saves to localStorage

2. AUTHENTICATED REQUESTS
   Frontend reads token from localStorage
        â†“
   Add to request header:
   Authorization: Bearer <token>
        â†“
   Backend verifies token signature
        â†“
   Check expiration
        â†“
   Verify role === "admin"
        â†“
   Process request

3. LOGOUT
   Frontend removes token from localStorage
        â†“
   Redirect to login page

4. TOKEN EXPIRY
   After 24 hours, token becomes invalid
        â†“
   Backend returns 401 Unauthorized
        â†“
   Frontend redirects to login
```

## ğŸ“Š Data Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Shopify Data Structure                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CUSTOMER
â”œâ”€â”€ id (number) - Shopify customer ID
â”œâ”€â”€ first_name (string)
â”œâ”€â”€ last_name (string)
â”œâ”€â”€ email (string) - UNIQUE
â”œâ”€â”€ tags (string) - Comma-separated
â”‚   â””â”€â”€ Examples:
â”‚       â”œâ”€â”€ "access-request,pending-review"
â”‚       â”œâ”€â”€ "access-request,approved"
â”‚       â””â”€â”€ "access-request,rejected"
â”œâ”€â”€ note (string) - Human-readable summary
â””â”€â”€ metafields (array)
    â””â”€â”€ namespace: "access_request"
        â”œâ”€â”€ company (single_line_text_field)
        â”œâ”€â”€ location (single_line_text_field)
        â”œâ”€â”€ machine_count (single_line_text_field)
        â”œâ”€â”€ role (single_line_text_field)
        â”œâ”€â”€ message (multi_line_text_field)
        â”œâ”€â”€ submitted_at (single_line_text_field) - ISO 8601
        â””â”€â”€ status (single_line_text_field)
            â””â”€â”€ Values: "pending" | "approved" | "rejected"
```

## ğŸŒ Environment Variables

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Environment Configuration                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SHOPIFY_STORE_DOMAIN
â”œâ”€â”€ Format: yourstore.myshopify.com
â”œâ”€â”€ Used by: All API functions
â””â”€â”€ Purpose: Shopify API endpoint

SHOPIFY_ADMIN_ACCESS_TOKEN
â”œâ”€â”€ Format: shpat_xxxxxxxxxxxxx
â”œâ”€â”€ Used by: All API functions
â””â”€â”€ Purpose: Authenticate with Shopify API

ADMIN_EMAIL
â”œâ”€â”€ Format: email@domain.com
â”œâ”€â”€ Used by: admin-login.ts
â””â”€â”€ Purpose: Admin authentication

ADMIN_PASSWORD
â”œâ”€â”€ Format: any string
â”œâ”€â”€ Used by: admin-login.ts
â””â”€â”€ Purpose: Admin authentication

JWT_SECRET
â”œâ”€â”€ Format: base64 string (32+ chars)
â”œâ”€â”€ Used by: admin-login.ts, get-access-requests.ts,
â”‚            update-request-status.ts
â””â”€â”€ Purpose: Sign and verify JWT tokens
```

---

**This architecture provides a secure, scalable solution for managing access requests through Shopify! ğŸš€**

